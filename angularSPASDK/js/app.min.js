!function(e){"use strict";var t=e.module("ngLoadScript",[]);t.directive("script",function(){return{restrict:"E",scope:!1,link:function(e,t,n){if("text/javascript-lazy"===n.type){var a=t.text(),r=new Function(a);r()}}}})}(angular);var module=angular.module("app",["ngCookies","ngRoute"]);module.directive("script",function(){return{restrict:"E",scope:!1,link:function(e,t,n){if("text/javascript-lazy"===n.type){var a=document.createElement("script");a.type="text/javascript";var r=t.attr("src");if(void 0!==r)a.src=r;else{var o=t.text();a.text=o}document.head.appendChild(a),t.remove()}}}}),module.config(["$locationProvider",function(){}]),module.config(function(e){e.when("/",{templateUrl:"/templates/contents/index.php",controller:"InfoCtrl"}).when("/index",{templateUrl:"/templates/contents/index.php",controller:"InfoCtrl"}).when("/order",{templateUrl:"/templates/contents/order.php",controller:"CcCtrl"}).when("/success",{templateUrl:"/templates/contents/success.php",controller:"SuccessCtrl"}).when("/step2-order",{templateUrl:"/templates/contents/step2-order.php",controller:"CcCtrl"}).when("/step2-success",{templateUrl:"/templates/contents/step2-success.php",controller:"SuccessCtrl"}).when("/step3",{templateUrl:"/templates/contents/step3-order.php",controller:"CcCtrl"}).otherwise({redirectTo:"/"})}),module.filter("range",function(){var e=function(e,t,n){for(var a=t;n>=a;a++)e.push(a);return e};return e}),module.directive("cardExpiration",function(e){var t={require:"ngModel",link:function(t){t.$watch("[ccinfo.expMonth,ccinfo.expYear]",function(){return""!=t.ccinfo.expMonth&&""!=t.ccinfo.expYear&&(today=new Date,selected=new Date,selected.setMonth(t.ccinfo.expMonth),selected.setYear(t.ccinfo.expYear),today>=selected)?(e.alert("Please select a valid date!"),t.ccinfo.expYear="",t.ccinfo.expMonth="",!1):!0},!0)}};return t}),module.directive("staticInclude",["$http","$templateCache","$compile","$timeout",function(e,t,n,a){return function(r,o,i){a(function(){var a=i.staticInclude;e.get(a,{cache:t}).success(function(e){var t=o.html(e).contents();n(t)(r)})},"1500")}}]),module.directive("onlyDigits",function(){return{require:"ngModel",restrict:"A",link:function(e,t,n,a){function r(e){if(e){var t=e.replace(/[^0-9]/g,"");return t!==e&&(a.$setViewValue(t),a.$render()),parseInt(t,10)}return void 0}a.$parsers.push(r)}}}),module.factory("AlertHandler",function(){return{alert:function(e){jError("<div>We are sorry but we could not process your request.<br/><h2>"+e+"</h2>Please correct and try again.</div>",{autoHide:!0,TimeShown:3e3,HorizontalPosition:"center",onCompleted:function(){}})}}}),module.factory("ServiceHandler",["$http",function(e){return{post:function(t,n){return e.post("TriangleCRM/Controller.php",{action:t,data:n})}}}]),module.factory("BakeCookie",function(e){return{set:function(t,n){e.put(t,n)},remove:function(t){e.remove(t)},get:function(t){return e.get(t)}}}),module.factory("encrypt",function(){return{encryptData:function(e){var t="-----BEGIN PUBLIC KEY-----MFwwDQYJKoZIhvcNAQEBBQADSwAwSAJBAM1RXGYKyXlCGcGvFYeNCD+yzVAOoK+w2awyE6vOCSqhR0pAWFgpWOuwbrL5M78PILmZc85ipbzoz6Vtv4IvYJUCAwEAAQ==-----END PUBLIC KEY-----",n=RSA.getPublicKey(t);return RSA.encrypt(e,n)}}}),module.factory("ParameterByName",function(){return{get:function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)"),n=t.exec(location.search);return null==n?"":decodeURIComponent(n[1].replace(/\+/g," "))}}}),module.controller("CcCtrl",function(e,t,n,a,r,o,i,c,s){billingInfo=i.get("billingInfo"),void 0==billingInfo&&(n.location.href="#/?redirected=1"),e.templates={header:"templates/headers/header.html",templateCC:"templates/ccTemplate.html",footer:"templates/footers/footer.html",content:"templates/contents/order.html",content2:"templates/contents/step2-order.html"},e.ccinfo={},e.ccinfo.planID=orderSettings.Result.planID,e.ccinfo.trialPackageID=orderSettings.Result.trialPackageID,e.ccinfo.chargeForTrial=orderSettings.Result.chargeForTrial,e.ccinfo.campaign_id=orderSettings.Result.campaign_id,e.ccinfo.firstName=billingInfo.firstName,e.ccinfo.lastName=billingInfo.lastName,e.ccinfo.address1=billingInfo.address1,e.ccinfo.address2=billingInfo.address2||"",e.ccinfo.city=billingInfo.city,e.ccinfo.state=billingInfo.state,e.ccinfo.zip=billingInfo.zip,e.ccinfo.country=billingInfo.country,e.ccinfo.phone=billingInfo.phone,e.ccinfo.email=billingInfo.email,e.ccinfo.sendConfirmationEmail=orderSettings.Result.sendConfirmationEmail,e.ccinfo.affiliate=s.get("aff")||"",e.ccinfo.subAffiliate=s.get("sub")||"",e.ccinfo.prospectID=billingInfo.ProspectID,e.ccinfo.description=orderSettings.Result.description,e.ccinfo.successRedirect=orderSettings.Result.successRedirect,e.currentYear=(new Date).getFullYear(),e.currentMonth=(new Date).getMonth()+1,e.months=t.DATETIME_FORMATS.MONTH,e.showEl=orderShowEl.Result,e.save=function(){$("#button-processing").show(),$("#button-submit").hide();var t=e.ccinfo.creditCard;return e.ccinfo.creditCard=c.encryptData(t),jsonObj=JSON.stringify(e.ccinfo),a.post("CreateSubscription",jsonObj).then(function(a){if("Success"==a.data.State){internal=!0;var r=e.ccinfo.successRedirect;n.location.href="#/"+r.split(".")[0]}else if("Test charge. ERROR"==a.data.Info){var r=e.ccinfo.successRedirect;n.location.href="#/"+r.split(".")[0]+"?successDownSell"+orderSettings.Result.successDownSell}else $("#button-processing").hide(),$("#button-submit").show(),e.ccinfo.creditCard=t,o.alert(a.data.Info)}),!1},e.hoverIn=function(){jQuery(".whatiscvv").stop(!0,!1).show("slow")},e.hoverOut=function(){jQuery(".whatiscvv").stop(!0,!1).hide("slow")},e.typeChange=function(){var t=e.ccinfo.paymentType;1==t?($("#cc_number").attr("pattern","{15}"),$("#cc_number").attr("maxlength","15"),$("#cc_number").mask("9999-999999-99999"),$("#cc_cvv").attr("pattern","[0-9]{4}"),$("#cc_cvv").mask("9999"),$("#cc_cvv").attr("maxlength","4")):($("#cc_number").attr("pattern","{13,16}"),$("#cc_number").attr("maxlength","16"),$("#cc_number").mask("9999-9999-9999-9999"),$("#cc_cvv").attr("pattern","[0-9]{3}"),$("#cc_cvv").mask("999"),$("#cc_cvv").attr("maxlength","3"))},e.getDate=function(e){var t=new Array("Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"),n=new Array("January","February","March","April","May","June","July","August","September","October","November","December"),a=new Date;a.setDate(a.getDate()+e);var r=t[a.getDay()]+", "+n[a.getMonth()]+" "+a.getDate()+", "+a.getFullYear();return r},e.ccCheck=function(){var t=e.ccinfo.paymentType,n=$("#cc_number").val();void 0==t?o.alert("Please select a Card Type first"):void 0==n||(1==t?15!=n.toString().length&&o.alert("The credit card number for AMEX should have 15 digits"):16!=n.toString().length&&o.alert("The credit card number for Visa, MasterCard and Discover should have 15 digits"))},e.cvvCheck=function(){var t=e.ccinfo.paymentType,n=$("#cc_cvv").val();void 0==t?o.alert("Please select a Card Type first"):void 0==n||(1==t?4!=n.toString().length&&o.alert("The CVV number for AMEX should have 4 digits"):3!=n.toString().length&&o.alert("The CVV number for Visa, MasterCard and Discover should have 3 digits"))}}),module.controller("InfoCtrl",["$scope","$window","$location","ServiceHandler","AlertHandler","BakeCookie","ParameterByName",function(e,t,n,a,r,o){1==n.search().redirected&&r.alert("You're here because a this information is needed"),e.$on("$destroy",function(){window.onbeforeunload=void 0}),e.$on("$locationChangeStart",function(e){confirm("Are you sure you want to leave this page?")||e.preventDefault()}),e.templates={header:"templates/headers/header.html",templateBill:"templates/billingTemplate.html",footer:"templates/footers/footer.html",content:"templates/contents/index.html"},e.billinfo={},e.billinfo.step="1",e.billinfo.hasFormSubmitted="",e.billinfo.campaign_id="117",e.billinfo.domain_name=n.host()+"/specialoffer/",e.billinfo.country="US",jQuery("#header-alert").show(),e.showEl=indexShowEl.Result,e.states=[{name:"Alabama",abbreviation:"AL"},{name:"Alaska",abbreviation:"AK"},{name:"Arizona",abbreviation:"AZ"},{name:"Arkansas",abbreviation:"AR"},{name:"California",abbreviation:"CA"},{name:"Colorado",abbreviation:"CO"},{name:"Connecticut",abbreviation:"CT"},{name:"Delaware",abbreviation:"DE"},{name:"District Of Columbia",abbreviation:"DC"},{name:"Florida",abbreviation:"FL"},{name:"Georgia",abbreviation:"GA"},{name:"Hawaii",abbreviation:"HI"},{name:"Idaho",abbreviation:"ID"},{name:"Illinois",abbreviation:"IL"},{name:"Indiana",abbreviation:"IN"},{name:"Iowa",abbreviation:"IA"},{name:"Kansas",abbreviation:"KS"},{name:"Kentucky",abbreviation:"KY"},{name:"Louisiana",abbreviation:"LA"},{name:"Maine",abbreviation:"ME"},{name:"Maryland",abbreviation:"MD"},{name:"Massachusetts",abbreviation:"MA"},{name:"Michigan",abbreviation:"MI"},{name:"Minnesota",abbreviation:"MN"},{name:"Mississippi",abbreviation:"MS"},{name:"Missouri",abbreviation:"MO"},{name:"Montana",abbreviation:"MT"},{name:"Nebraska",abbreviation:"NE"},{name:"Nevada",abbreviation:"NV"},{name:"New Hampshire",abbreviation:"NH"},{name:"New Jersey",abbreviation:"NJ"},{name:"New Mexico",abbreviation:"NM"},{name:"New York",abbreviation:"NY"},{name:"North Carolina",abbreviation:"NC"},{name:"North Dakota",abbreviation:"ND"},{name:"Ohio",abbreviation:"OH"},{name:"Oklahoma",abbreviation:"OK"},{name:"Oregon",abbreviation:"OR"},{name:"Pennsylvania",abbreviation:"PA"},{name:"Rhode Island",abbreviation:"RI"},{name:"South Carolina",abbreviation:"SC"},{name:"South Dakota",abbreviation:"SD"},{name:"Tennessee",abbreviation:"TN"},{name:"Texas",abbreviation:"TX"},{name:"Utah",abbreviation:"UT"},{name:"Vermont",abbreviation:"VT"},{name:"Virginia",abbreviation:"VA"},{name:"Washington",abbreviation:"WA"},{name:"West Virginia",abbreviation:"WV"},{name:"Wisconsin",abbreviation:"WI"},{name:"Wyoming",abbreviation:"WY"}],e.save=function(e){return $("#button-submit").hide(),$("#button-processing").show(),jsonObj=JSON.stringify(e),a.post("createprospect",jsonObj).then(function(n){"Success"==n.data.State?(e.ProspectID=n.data.Result.ProspectID,o.set("billingInfo",e),internal=!0,t.location.href="#/order"):($("#button-processing").hide(),$("#button-submit").show(),r.alert(n.data.Info))}),!1},e.processing=function(){},e.getDate=function(e){var t=new Array("Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"),n=new Array("January","February","March","April","May","June","July","August","September","October","November","December"),a=new Date;a.setDate(a.getDate()+e);var r=t[a.getDay()]+", "+n[a.getMonth()]+" "+a.getDate()+", "+a.getFullYear();return r}}]),module.controller("SuccessCtrl",function(e){e.templates={header:"templates/headers/header.html",footer:"templates/footers/footer.html",content:"templates/contents/success.html"}});